@page "/style/{Id}"
@attribute [Authorize]
@inject IStyleService StyleService
@inject NavigationManager Nav

<PageTitle>@(_style?.Title ?? "스타일 상세") - 늘-오던 헤어살롱</PageTitle>

<div class="container salon-detail-page">
    <!-- 뒤로가기 -->
    <button class="btn btn-back" @onclick="GoBack">
        <i class="bi bi-chevron-left"></i> 목록
    </button>

    @if (_loading)
    {
        <div class="skeleton-detail">
            <div class="skeleton skeleton-title mx-auto"></div>
            <div class="skeleton skeleton-text-sm mx-auto mb-3" style="width:30%"></div>
            <div class="skeleton skeleton-text mt-3"></div>
            <div class="skeleton skeleton-text" style="width:90%"></div>
            <div class="skeleton skeleton-image mt-3"></div>
        </div>
    }
    else if (_style == null)
    {
        <div class="text-center py-5">
            <p class="text-muted">스타일을 찾을 수 없습니다.</p>
            <a href="" class="btn btn-salon">홈으로 돌아가기</a>
        </div>
    }
    else
    {
        <!-- 제목 -->
        <h1 class="detail-title">@_style.Title</h1>

        <!-- 카테고리 & 시술 태그 -->
        <div class="detail-tags">
            <span class="detail-tag @(_style.Category.IsFemale() ? "tag-female" : "tag-male")">@_style.Category.ToFullName()</span>
            <span class="detail-tag tag-service">@_style.Service</span>
        </div>

        <!-- 상세 설명 -->
        @if (!string.IsNullOrEmpty(_style.Description))
        {
            <div class="detail-description">
                @((MarkupString)_style.Description)
            </div>
        }

        <!-- 이미지 캐러셀 -->
        <ImageCarousel ImageUrls="_style.ImageUrls" />

        <!-- 해시태그 -->
        @if (_style.Hashtags.Any())
        {
            <HashtagList Hashtags="_style.Hashtags" />
        }

        <!-- 연관 게시글 -->
        @if (_style.RelatedPostIds.Any())
        {
            <RelatedPosts RelatedPostIds="_style.RelatedPostIds" />
        }
    }
</div>

@code {
    [Parameter] public string Id { get; set; } = "";

    private StylePost? _style;
    private bool _loading = true;

    protected override async Task OnParametersSetAsync()
    {
        _loading = true;
        _style = await StyleService.GetByIdAsync(Id);
        _loading = false;
    }

    private void GoBack()
    {
        Nav.NavigateTo("");
    }
}

<style>
    .salon-detail-page {
        max-width: 640px;
        padding: 0.5rem 1rem 2rem;
    }

    /* 뒤로가기 */
    .btn-back {
        font-family: var(--font-serif);
        font-size: 0.82rem;
        color: var(--salon-gray);
        background: none;
        border: none;
        padding: 0.6rem 0;
        margin-bottom: 0.3rem;
        transition: color 0.2s;
    }

    .btn-back:hover {
        color: var(--salon-black);
    }

    .btn-back i {
        font-size: 0.75rem;
    }

    /* 제목 */
    .detail-title {
        font-family: var(--font-serif);
        font-size: 1.4rem;
        font-weight: 900;
        color: var(--salon-black);
        text-align: center;
        margin: 0.3rem 0 0.6rem;
        line-height: 1.5;
        letter-spacing: -0.02em;
    }

    /* 카테고리 & 성별 태그 */
    .detail-tags {
        display: flex;
        justify-content: center;
        gap: 0.4rem;
        margin-bottom: 1rem;
    }

    .detail-tag {
        font-family: var(--font-serif);
        font-size: 0.72rem;
        padding: 3px 14px;
        border-radius: 12px;
        letter-spacing: 0.05em;
        font-weight: 500;
    }

    .tag-female {
        background: var(--salon-rose);
        color: #fff;
    }

    .tag-male {
        background: #6b9bd2;
        color: #fff;
    }

    .tag-service {
        background: var(--salon-dark);
        color: #fff;
    }

    /* 상세 설명 */
    .detail-description {
        font-family: var(--font-serif);
        font-size: 0.88rem;
        line-height: 1.9;
        color: var(--salon-dark);
        padding: 0.8rem 0.2rem 1rem;
        word-break: keep-all;
    }

    .detail-description p {
        margin-bottom: 0.6rem;
    }

    .detail-description h3 {
        font-size: 1rem;
        font-weight: 700;
        margin: 1rem 0 0.4rem;
    }

    .detail-description hr {
        border: none;
        border-top: 1px solid var(--salon-light-gray);
        margin: 1rem 0;
    }

    @@media (max-width: 576px) {
        .detail-title {
            font-size: 1.15rem;
        }

        .detail-description {
            font-size: 0.84rem;
            line-height: 1.8;
        }
    }
</style>
