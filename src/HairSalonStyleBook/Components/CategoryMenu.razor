@using HairSalonStyleBook.Models

<div class="filter-bar">
    <!-- 카테고리 셀렉트 -->
    <div class="filter-select-wrapper">
        <i class="bi bi-person filter-select-icon"></i>
        <select class="form-select filter-select"
                value="@((int)SelectedCategory)"
                @onchange="OnCategoryChange">
            @foreach (var category in _categories)
            {
                <option value="@((int)category)">@GetLabel(category)</option>
            }
        </select>
        <i class="bi bi-chevron-down filter-chevron"></i>
    </div>

    <!-- 시술 셀렉트 -->
    <div class="filter-select-wrapper">
        <i class="bi bi-scissors filter-select-icon"></i>
        <select class="form-select filter-select"
                value="@((int)SelectedService)"
                @onchange="OnServiceChange">
            <option value="-1">시술 전체</option>
            @foreach (var svc in _services)
            {
                <option value="@((int)svc)">@GetServiceLabel(svc)</option>
            }
        </select>
        <i class="bi bi-chevron-down filter-chevron"></i>
    </div>
</div>

@code {
    [Parameter] public StyleCategory SelectedCategory { get; set; } = StyleCategory.전체;
    [Parameter] public EventCallback<StyleCategory> OnCategorySelected { get; set; }
    [Parameter] public int SelectedService { get; set; } = -1;
    [Parameter] public EventCallback<int> OnServiceSelected { get; set; }

    private readonly StyleCategory[] _categories =
    {
        StyleCategory.전체,
        StyleCategory.남성,
        StyleCategory.여성숏,
        StyleCategory.여성단발,
        StyleCategory.여성미디움,
        StyleCategory.여성롱
    };

    private readonly ServiceType[] _services =
    {
        ServiceType.커트,
        ServiceType.펌,
        ServiceType.염색
    };

    private async Task OnCategoryChange(ChangeEventArgs e)
    {
        if (int.TryParse(e.Value?.ToString(), out var val))
        {
            await OnCategorySelected.InvokeAsync((StyleCategory)val);
        }
    }

    private async Task OnServiceChange(ChangeEventArgs e)
    {
        if (int.TryParse(e.Value?.ToString(), out var val))
        {
            await OnServiceSelected.InvokeAsync(val);
        }
    }

    private static string GetLabel(StyleCategory category) => category switch
    {
        StyleCategory.전체 => "카테고리 전체",
        StyleCategory.남성 => "남성",
        StyleCategory.여성숏 => "여성 · 숏",
        StyleCategory.여성단발 => "여성 · 단발",
        StyleCategory.여성미디움 => "여성 · 미디움",
        StyleCategory.여성롱 => "여성 · 롱",
        _ => category.ToString()
    };

    private static string GetServiceLabel(ServiceType svc) => svc switch
    {
        ServiceType.커트 => "커트",
        ServiceType.펌 => "펌",
        ServiceType.염색 => "염색",
        _ => svc.ToString()
    };
}

<style>
    .filter-bar {
        display: flex;
        justify-content: center;
        gap: 0.6rem;
        padding: 0.8rem 1rem 0.3rem;
        max-width: 460px;
        margin: 0 auto;
    }

    .filter-select-wrapper {
        position: relative;
        flex: 1;
        min-width: 0;
    }

    .filter-select-icon {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--salon-accent);
        font-size: 0.78rem;
        pointer-events: none;
        z-index: 1;
    }

    .filter-chevron {
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--salon-gray);
        font-size: 0.6rem;
        pointer-events: none;
        transition: color 0.3s;
    }

    .filter-select {
        font-family: var(--font-serif);
        font-size: 0.8rem;
        color: var(--salon-dark);
        background: var(--salon-white);
        border: 1px solid var(--salon-light-gray);
        border-radius: 10px;
        padding: 0.55rem 2rem 0.55rem 2.2rem;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        width: 100%;
        letter-spacing: 0.02em;
    }

    .filter-select:focus {
        border-color: var(--salon-green);
        box-shadow: 0 0 0 3px rgba(123, 163, 131, 0.1), 0 2px 8px rgba(123, 163, 131, 0.08);
        outline: none;
    }

    .filter-select:hover {
        border-color: var(--salon-green);
        box-shadow: 0 2px 8px rgba(123, 163, 131, 0.1);
    }

    .filter-select-wrapper:focus-within .filter-select-icon {
        color: var(--salon-green);
    }

    .filter-select-wrapper:focus-within .filter-chevron {
        color: var(--salon-green);
    }

    @@media (max-width: 576px) {
        .filter-bar {
            gap: 0.4rem;
            padding: 0.6rem 0.5rem 0.2rem;
        }

        .filter-select {
            font-size: 0.73rem;
            padding: 0.5rem 1.8rem 0.5rem 2rem;
        }

        .filter-select-icon {
            font-size: 0.7rem;
            left: 10px;
        }
    }

    /* 태블릿 반응형 */
    @@media (min-width: 768px) {
        .filter-bar {
            max-width: 540px;
        }

        .filter-select {
            font-size: 0.92rem;
            padding: 0.65rem 2.2rem 0.65rem 2.5rem;
        }

        .filter-select-icon {
            font-size: 0.88rem;
        }
    }
</style>
