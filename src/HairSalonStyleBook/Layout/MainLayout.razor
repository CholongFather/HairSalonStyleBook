@inherits LayoutComponentBase
@inject NavigationManager Nav
@implements IDisposable

<div class="salon-app">
    <Header />
    <RibbonDivider />
    <main class="salon-content">
        <div class="page-slide-container">
            <div class="page-transition @_animClass">
                @Body
            </div>
        </div>
    </main>
    <Footer />
</div>

@code {
    private string _animClass = "page-enter";

    protected override void OnInitialized()
    {
        Nav.LocationChanged += OnLocationChanged;
    }

    private async void OnLocationChanged(object? sender, Microsoft.AspNetCore.Components.Routing.LocationChangedEventArgs e)
    {
        // 나가는 애니메이션
        _animClass = "page-exit";
        await InvokeAsync(StateHasChanged);

        // 짧은 딜레이 후 들어오는 애니메이션
        await Task.Delay(250);
        _animClass = "page-enter";
        await InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        Nav.LocationChanged -= OnLocationChanged;
    }
}

<style>
    .page-slide-container {
        overflow: hidden;
    }

    .page-transition {
        animation-fill-mode: both;
        animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);
        position: relative;
    }

    .page-enter {
        animation: fadeIn 0.3s ease;
    }

    .page-exit {
        animation: fadeOut 0.2s ease;
    }

    @@keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @@keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; }
    }
</style>
