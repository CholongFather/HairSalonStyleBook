@inherits LayoutComponentBase
@inject NavigationManager Nav
@implements IDisposable

<div class="salon-app">
    <Header />
    <RibbonDivider />
    <main class="salon-content">
        <div class="page-transition @_animClass">
            @Body
        </div>
    </main>
    <Footer />
</div>

@code {
    private string _animClass = "page-enter";

    protected override void OnInitialized()
    {
        Nav.LocationChanged += OnLocationChanged;
    }

    private async void OnLocationChanged(object? sender, Microsoft.AspNetCore.Components.Routing.LocationChangedEventArgs e)
    {
        // 나가는 애니메이션
        _animClass = "page-exit";
        await InvokeAsync(StateHasChanged);

        // 짧은 딜레이 후 들어오는 애니메이션
        await Task.Delay(200);
        _animClass = "page-enter";
        await InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        Nav.LocationChanged -= OnLocationChanged;
    }
}

<style>
    .page-transition {
        animation-duration: 0.35s;
        animation-fill-mode: both;
        animation-timing-function: ease-out;
    }

    /* 페이지 들어옴 - 책장 넘기듯 오른쪽에서 */
    .page-enter {
        animation-name: pageFlipIn;
    }

    /* 페이지 나감 - 왼쪽으로 넘어감 */
    .page-exit {
        animation-name: pageFlipOut;
        animation-duration: 0.2s;
    }

    @@keyframes pageFlipIn {
        0% {
            opacity: 0;
            transform: perspective(1200px) rotateY(-8deg) translateX(30px);
        }
        100% {
            opacity: 1;
            transform: perspective(1200px) rotateY(0deg) translateX(0);
        }
    }

    @@keyframes pageFlipOut {
        0% {
            opacity: 1;
            transform: perspective(1200px) rotateY(0deg) translateX(0);
        }
        100% {
            opacity: 0;
            transform: perspective(1200px) rotateY(4deg) translateX(-20px);
        }
    }
</style>
