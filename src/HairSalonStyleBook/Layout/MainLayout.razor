@inherits LayoutComponentBase
@inject NavigationManager Nav
@implements IDisposable

<div class="salon-app">
    <Header />
    <RibbonDivider />
    <main class="salon-content">
        <div class="page-slide-container">
            <div class="page-transition @_animClass">
                @Body
            </div>
        </div>
    </main>
    <Footer />
</div>

@code {
    private string _animClass = "page-enter";

    protected override void OnInitialized()
    {
        Nav.LocationChanged += OnLocationChanged;
    }

    private async void OnLocationChanged(object? sender, Microsoft.AspNetCore.Components.Routing.LocationChangedEventArgs e)
    {
        // 나가는 애니메이션
        _animClass = "page-exit";
        await InvokeAsync(StateHasChanged);

        // 짧은 딜레이 후 들어오는 애니메이션
        await Task.Delay(250);
        _animClass = "page-enter";
        await InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        Nav.LocationChanged -= OnLocationChanged;
    }
}

<style>
    .page-slide-container {
        perspective: 1200px;
        overflow: hidden;
    }

    .page-transition {
        animation-fill-mode: both;
        animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);
        position: relative;
    }

    /* 페이지 들어옴 - 책넘김 인 */
    .page-enter {
        animation-name: flipIn;
        animation-duration: 0.45s;
    }

    /* 페이지 나감 - 책넘김 아웃 */
    .page-exit {
        animation-name: flipOut;
        animation-duration: 0.25s;
    }

    @@keyframes flipIn {
        0% {
            opacity: 0;
            transform: rotateY(-12deg);
        }
        100% {
            opacity: 1;
            transform: rotateY(0);
        }
    }

    @@keyframes flipOut {
        0% {
            opacity: 1;
            transform: rotateY(0);
        }
        100% {
            opacity: 0;
            transform: rotateY(12deg);
        }
    }
</style>
